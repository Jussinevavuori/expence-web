(this.webpackJsonpexpence=this.webpackJsonpexpence||[]).push([[0],{199:function(e,t,n){e.exports=n(361)},224:function(e,t){},226:function(e,t){},240:function(e,t){},242:function(e,t){},270:function(e,t){},272:function(e,t){},273:function(e,t){},279:function(e,t){},281:function(e,t){},299:function(e,t){},302:function(e,t){},318:function(e,t){},321:function(e,t){},361:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(56),o=n.n(i),c=n(48),s=n(11),u=n(2),l=n.n(u),h=n(5),d=n(33),p=n(84),f=function(e){var t,n,a=Object(d.c)({resolver:Object(p.a)(z)}),i=a.register,o=a.handleSubmit,c=a.errors,s=a.formState,u=s.touched.email&&(null===(t=c.email)||void 0===t?void 0:t.message),l=s.touched.password&&(null===(n=c.password)||void 0===n?void 0:n.message);return r.a.createElement("div",{className:"LoginView"},r.a.createElement("form",{onSubmit:o(e.handleSubmit)},r.a.createElement("input",{id:"login-email",name:"email",type:"text",ref:i}),r.a.createElement("p",{style:{color:"#FF6622"}},u),r.a.createElement("input",{id:"login-password",name:"password",type:"password",ref:i}),r.a.createElement("p",{style:{color:"#FF6622"}},l),r.a.createElement("button",{type:"submit"},"Log in")),r.a.createElement("p",null,"or"),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.handleGoogleSubmit()}},r.a.createElement("button",{type:"submit"},"Log in with Google")))},m=n(18),g=n(13),b=n(8),v=n(30),y=n(42),E=n(386),w=function(){function e(t){Object(v.a)(this,e),this.date=void 0,this.category=void 0,this.comment=void 0,this.integerAmount=void 0,this.id=void 0,this.date=new Date(t.date),this.comment=t.comment||"",this.category=t.category,this.integerAmount=Math.floor(t.integerAmount),this.id=t.id||E.a()}return Object(y.a)(e,[{key:"amount",get:function(){return this.integerAmount/100}},{key:"unsignedIntegerAmount",get:function(){return Math.abs(this.integerAmount)}},{key:"unsignedAmount",get:function(){return Math.abs(this.amount)}},{key:"euros",get:function(){return this.integerAmount>0?Math.floor(this.integerAmount/100):Math.ceil(this.integerAmount/100)}},{key:"formatEuros",get:function(){return Math.abs(this.euros).toFixed(0)}},{key:"cents",get:function(){return Math.floor(this.integerAmount%100)}},{key:"formatCents",get:function(){return Math.abs(this.cents).toFixed(0).padStart(2,"0")}},{key:"sign",get:function(){return 0===this.integerAmount?0:this.integerAmount>0?1:-1}},{key:"formatSign",get:function(){return 0===this.integerAmount?"\xb1":this.integerAmount>0?"+":"-"}},{key:"formatFull",get:function(){return this.formatSign+this.formatEuros+"."+this.formatCents}}]),e}(),x=m.b({uid:m.d().defined(),date:m.a().defined(),category:m.d().defined(),integerAmount:m.a().defined().integer(),comment:m.d().optional().nullable(),id:m.d().optional().nullable()}).defined();function k(e){try{return x.validateSync(e),!0}catch(t){return!1}}var O=n(93),j=n(92),A=n(28),T=n(188),R=n.n(T),S={productionApiBaseURL:"https://expenceapp.herokuapp.com",developmentApiBaseURL:"http://localhost:4000",testApiBaseURL:"http://localhost:4000",getApiBaseURL:function(){return S.productionApiBaseURL}},F=n(189),B=n.n(F),C=function(){function e(){Object(v.a)(this,e),this.baseURL=void 0,this.axios=void 0,this.baseURL="".concat(S.getApiBaseURL(),"/api"),this.axios=R.a.create({baseURL:this.baseURL,withCredentials:!0})}return Object(y.a)(e,[{key:"endpoint",value:function(e){return"".concat(this.baseURL).concat(e)}},{key:"isAccessTokenValid",value:function(){var e=P.getState().authentication.accessToken;if(!e)return!1;try{var t=B.a.decode(e),n=1e3*Number((null===t||void 0===t?void 0:t.exp)||0);return Date.now()<n-5e3}catch(a){return console.warn("Error occured while checking access token",a),!1}}},{key:"attemptRefreshAccessToken",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t,n,a,r,i=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]&&i[0],this.isAccessTokenValid()&&!t){e.next=15;break}return n=this.endpoint("/auth/refresh_token"),e.prev=4,e.next=7,this.axios.get(n);case 7:a=e.sent,r=a.data,P.getActions().authentication.setAccessToken(r),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),P.getState().authentication.accessToken&&P.getActions().authentication.logOut();case 15:case"end":return e.stop()}}),e,this,[[4,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"onBeforeRequest",value:function(){var e=Object(h.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.attemptRefreshAccessToken();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onAfterRequest",value:function(){var e=Object(h.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getDefaultAxiosConfig",value:function(){var e=P.getState().authentication.accessToken;return{headers:{Authorization:"bearer ".concat(String(e))}}}},{key:"get",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n){var a,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.endpoint(t),e.next=3,this.onBeforeRequest();case 3:return r=Object(A.a)(Object(A.a)({},n),this.getDefaultAxiosConfig()),e.next=6,this.axios.get(a,r);case 6:return i=e.sent,e.next=9,this.onAfterRequest();case 9:return e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n,a){var r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.endpoint(t),e.next=3,this.onBeforeRequest();case 3:return i=Object(A.a)(Object(A.a)({},a),this.getDefaultAxiosConfig()),e.next=6,this.axios.post(r,i);case 6:return o=e.sent,e.next=9,this.onAfterRequest();case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n){var a,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.endpoint(t),e.next=3,this.onBeforeRequest();case 3:return r=Object(A.a)(Object(A.a)({},n),this.getDefaultAxiosConfig()),e.next=6,this.axios.delete(a,r);case 6:return i=e.sent,e.next=9,this.onAfterRequest();case 9:return e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n,a){var r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.endpoint(t),e.next=3,this.onBeforeRequest();case 3:return i=Object(A.a)(Object(A.a)({},a),this.getDefaultAxiosConfig()),e.next=6,this.axios.put(r,n,i);case 6:return o=e.sent,e.next=9,this.onAfterRequest();case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"patch",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n,a){var r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.endpoint(t),e.next=3,this.onBeforeRequest();case 3:return i=Object(A.a)(Object(A.a)({},a),this.getDefaultAxiosConfig()),e.next=6,this.axios.patch(r,n,i);case 6:return o=e.sent,e.next=9,this.onAfterRequest();case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()}]),e}(),N=new(function(e){Object(O.a)(n,e);var t=Object(j.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"getTransactions",value:function(){return this.get("/transactions")}},{key:"postTransaction",value:function(e){return this.post("/transactions",e)}},{key:"deleteTransaction",value:function(e){return this.delete("/transactions/".concat(e))}},{key:"patchTransaction",value:function(e){if(e.id)return this.patch("/transactions/".concat(e.id))}}]),n}(C)),L={items:[],count:Object(g.c)((function(e){return e.items.length})),getTransactions:Object(g.f)(function(){var e=Object(h.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.getTransactions();case 2:n=e.sent,a=n.data,Array.isArray(a)&&a.every(k)&&t.createTransactions(n.data);case 4:case"end":return e.stop()}var a}),e)})));return function(t){return e.apply(this,arguments)}}()),createTransaction:Object(g.b)((function(e,t){e.items.push(new w(t))})),createTransactions:Object(g.b)((function(e,t){var n;(n=e.items).push.apply(n,Object(b.a)(t.map((function(e){return new w(e)}))))})),removeTransaction:Object(g.b)((function(e,t){e.items=e.items.filter((function(e){return e.id!==t}))})),updateTransaction:Object(g.b)((function(e,t){e.items=e.items.map((function(e){return e.id===t.id?new w(t):e}))}))},U=function e(t){Object(v.a)(this,e),this.id=void 0,this.displayName=void 0,this.email=void 0,this.photoUrl=void 0,this.googleId=void 0,this.id=t.id,this.displayName=t.displayName||void 0,this.email=t.email||void 0,this.photoUrl=t.photoUrl||void 0,this.googleId=t.googleId||void 0};function D(e){return"string"===typeof e||void 0===e||null===e}var I=new(function(e){Object(O.a)(n,e);var t=Object(j.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"getProfile",value:function(){return this.get("/auth/profile")}},{key:"registerWithEmailAndPassword",value:function(e){return this.post("/auth/register",e)}},{key:"logInWithEmailAndPassword",value:function(e){return this.post("/auth/login",e)}},{key:"logInWithGoogle",value:function(){window.location.href=this.endpoint("/auth/google")}},{key:"logOut",value:function(){window.location.href=this.endpoint("/auth/logout")}}]),n}(C)),q={transactions:L,authentication:{loading:!0,setLoading:Object(g.b)((function(e){e.loading=!1})),user:null,isLoggedIn:Object(g.c)((function(e){return Boolean(e.user)})),applyUserConstructable:Object(g.b)((function(e,t){e.user=new U(t)})),accessToken:null,setAccessToken:Object(g.b)((function(e,t){e.accessToken=t})),getProfile:Object(g.f)(function(){var e=Object(h.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.getProfile();case 3:n=e.sent,"object"===typeof(a=n.data)&&function(e){return"string"===typeof e&&e.length>0}(a.id)&&D(a.displayName)&&D(a.googleId)&&D(a.photoUrl)&&D(a.email)&&t.applyUserConstructable(n.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn("Not logged in");case 10:return e.prev=10,t.setLoading(!1),e.finish(10);case 13:case"end":return e.stop()}var a}),e,null,[[0,7,10,13]])})));return function(t){return e.apply(this,arguments)}}()),logInWithGoogle:Object(g.f)((function(){I.logInWithGoogle()})),logOut:Object(g.f)((function(){I.logOut()}))}},P=Object(g.d)(q);var W=Object(g.e)(),M=W.useStoreActions,G=(W.useStoreDispatch,W.useStoreState),z=(W.useStore,m.b({email:m.d().defined().min(3).max(255).email(),password:m.d().defined().min(3).max(255)}).defined()),V=function(){var e=M((function(e){return e.authentication.logInWithGoogle}));function t(){return(t=Object(h.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Submitted");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function n(){return(n=Object(h.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e();case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return r.a.createElement(f,{handleGoogleSubmit:function(){return n.apply(this,arguments)},handleSubmit:function(e){return t.apply(this,arguments)}})},J=function(e){var t,n,a,i=Object(d.c)({resolver:Object(p.a)(H)}),o=i.register,c=i.handleSubmit,s=i.errors,u=i.formState,l=u.touched.email&&(null===(t=s.email)||void 0===t?void 0:t.message),h=u.touched.password&&(null===(n=s.password)||void 0===n?void 0:n.message),f=u.touched.repeatPassword&&(null===(a=s.repeatPassword)||void 0===a?void 0:a.message);return r.a.createElement("form",{onSubmit:c(e.handleSubmit)},r.a.createElement("input",{id:"register-email",name:"email",type:"text",ref:o}),r.a.createElement("p",{style:{color:"#FF6622"}},l),r.a.createElement("input",{id:"register-password",name:"password",type:"password",ref:o}),r.a.createElement("p",{style:{color:"#FF6622"}},h),r.a.createElement("input",{id:"register-repeat-password",name:"repeatPassword",type:"password",ref:o}),r.a.createElement("p",{style:{color:"#FF6622"}},f),r.a.createElement("button",{type:"submit"},"Register"))},H=m.b({email:m.d().defined().min(3).max(255).email(),password:m.d().defined().min(3).max(255),repeatPassword:m.d().defined().oneOf([m.c("password")],"passwords must match")}).defined(),Y=function(){function e(){return(e=Object(h.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Submitted");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement(J,{handleSubmit:function(t){return e.apply(this,arguments)}})},$=n(27),_=n.n($),K=n(385),Q=n(381),X=n(376),Z=n(377),ee=n(378),te=n(379),ne=n(380);function ae(){var e=re(),t=Object(s.g)(),n=Object(s.h)(pe.dashboard),a=Object(s.h)(pe.analytics),i=Object(s.h)(pe.budget),o=Object(s.h)(pe.settings);return r.a.createElement("div",{className:_()(e.root,"AppTabs")},r.a.createElement("div",{className:e.content},r.a.createElement("div",{className:e.spacer}),r.a.createElement("div",{className:_()(e.tab,{active:!!n})},r.a.createElement(K.a,{onClick:function(){return t.push(pe.dashboard)}},r.a.createElement(X.a,null))),r.a.createElement("div",{className:_()(e.tab,{active:!!a})},r.a.createElement(K.a,{onClick:function(){return t.push(pe.analytics)}},r.a.createElement(Z.a,null))),r.a.createElement("div",{className:_()(e.centerTab)},r.a.createElement("div",{className:_()(e.centerTabBackground)},r.a.createElement("svg",{id:"center-tab-svg",version:"1.1",x:"0px",y:"0px",width:"100px",height:"60px",viewBox:"0 0 100 60"},r.a.createElement("defs",null,r.a.createElement("clipPath",{id:"center-tab-clip-path"},r.a.createElement("path",{d:"M99.2,0C89.6,0,81,5.5,76.5,14c-5,9.5-15,16-26.5,16s-21.5-6.5-26.5-16C19,5.5,10.4,0,0.8,0L0,0v60h100V0\r L99.2,0z"}))))),r.a.createElement(K.a,{className:_()(e.floatingButton),onClick:function(){return console.log("Clicked")}},r.a.createElement(ee.a,null))),r.a.createElement("div",{className:_()(e.tab,{active:!!i})},r.a.createElement(K.a,{onClick:function(){return t.push(pe.budget)}},r.a.createElement(te.a,null))),r.a.createElement("div",{className:_()(e.tab,{active:!!o})},r.a.createElement(K.a,{onClick:function(){return t.push(pe.settings)}},r.a.createElement(ne.a,null))),r.a.createElement("div",{className:e.spacer})))}var re=Object(Q.a)((function(e){return{root:{width:"100%",height:"100%"},spacer:{height:"100%",width:e.spacing(2),background:e.palette.grey[50]},content:{display:"flex",height:"100%",filter:"drop-shadow(5px 5px 15px rgba(0,0,0,0.16))"},centerTabBackground:{background:e.palette.grey[50],width:"100%",height:"100%",clipPath:"url(#center-tab-clip-path)","#center-tab-svg, #center-tab-clip-path":{width:100,height:60}},centerTab:{position:"relative",width:100,height:60},floatingButton:{position:"absolute",top:0,left:"50%",transform:"translate(-50%,-50%)",borderRadius:"50%",background:e.palette.primary.main,filter:"drop-shadow(5px 5px 15px rgba(0,0,0,0.16))","& *":{color:"white"},"&:hover":{backgroundColor:e.palette.primary.light}},tab:{background:e.palette.grey[50],height:60,width:"100%",flex:1,display:"grid",placeItems:"center","& *":{color:e.palette.grey[600]},"&.active *":{color:e.palette.primary.main},"& .MuiIconButton-root":{height:"100%",width:"100%",borderRadius:0}}}}));function ie(e){var t=oe();return r.a.createElement("div",{className:_()("AppLayout",t.root)},r.a.createElement(ae,null),r.a.createElement("div",{className:t.childrenContainer},e.children))}var oe=Object(Q.a)((function(e){return{root:{overflow:"hidden",width:"100%",height:"100vh",maxWidth:"100%",maxHeight:"100vh",background:"white",display:"grid",gridTemplateRows:"auto 60px",gridTemplateColumns:"1fr",gridTemplateAreas:'"children" "navbar"',"& .AppTabs":{gridArea:"navbar"}},childrenContainer:{gridArea:"children",height:"100%",width:"100%",overflow:"auto"}}})),ce=n(196);function se(e){var t=e.fallbackRoute,n=Object(ce.a)(e,["fallbackRoute"]),a=pe.login,i=G((function(e){return e.authentication.loading})),o=G((function(e){return e.authentication.isLoggedIn}));return i?null:o?r.a.createElement(s.b,n):r.a.createElement(s.a,{to:t||a})}var ue=n(382);function le(e){var t=he(),n=G((function(e){return e.authentication.user}));return n?r.a.createElement("div",{className:t.root},r.a.createElement("header",{className:t.header},r.a.createElement(ue.a,{className:t.headerTitle},"Welcome back, ".concat(n.displayName))),r.a.createElement("section",null,r.a.createElement(ue.a,null,"Your transactions this month"))):null}var he=Object(Q.a)((function(e){return{root:{},header:{height:320,width:"100%",background:e.palette.primary.main,padding:e.spacing(2),"& *":{color:"#ffffff"}},headerTitle:{fontSize:1.5*e.typography.fontSize,fontWeight:e.typography.fontWeightBold}}}));function de(){return r.a.createElement("nav",{style:{margin:"0 0 16px 0",display:"flex",flexDirection:"row",height:40,background:"#204aa5",width:"100%",alignItems:"center"}},r.a.createElement(c.b,{to:pe.login,style:{color:"white",margin:"0 8px"}},"Login"),r.a.createElement(c.b,{to:pe.register,style:{color:"white",margin:"0 8px"}},"Register"))}var pe={approot:"/app",dashboard:"/app/dashboard",analytics:"/app/analytics",budget:"/app/budget",settings:"/app/settings",login:"/",register:"/register"};function fe(){return r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:pe.login},r.a.createElement(de,null),r.a.createElement(V,null)),r.a.createElement(s.b,{exact:!0,path:pe.register},r.a.createElement(de,null),r.a.createElement(Y,null)),r.a.createElement(se,{exact:!0,path:pe.dashboard},r.a.createElement(ie,null,r.a.createElement(le,null))),r.a.createElement(se,{exact:!0,path:pe.analytics},r.a.createElement(ie,null,r.a.createElement("p",null,"Analytics placeholder"))),r.a.createElement(se,{exact:!0,path:pe.budget},r.a.createElement(ie,null,r.a.createElement("p",null,"Budget placeholder"))),r.a.createElement(se,{exact:!0,path:pe.settings},r.a.createElement(ie,null,r.a.createElement("p",null,"Settings placeholder"))),r.a.createElement(s.b,{path:"/"},r.a.createElement(s.a,{to:pe.dashboard})))}var me=function(){var e=M((function(e){return e.authentication.getProfile}));return Object(a.useEffect)((function(){e()}),[e]),r.a.createElement(fe,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ge=n(383),be=n(384),ve=n(195),ye=n.n(ve)()({palette:{primary:{main:"#5E24FF",light:"#767EE5",dark:"#300D94",contrastText:"#ffffff",A100:"#5E24FF",A200:"#5E24FF",A400:"#5E24FF",A700:"#5E24FF",50:"#F7F3FF",100:"#AEB2EF",200:"#979DE8",300:"#767EE5",400:"#6A4EF6",500:"#5E24FF",600:"#420CD8",700:"#390CB5",800:"#300D94",900:"#200D55"}}});o.a.render(r.a.createElement(g.a,{store:P},r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.a,null,r.a.createElement(ge.a,{theme:ye},r.a.createElement(be.a,null),r.a.createElement(me,null))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[199,1,2]]]);
//# sourceMappingURL=main.488336bb.chunk.js.map